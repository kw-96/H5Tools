---
description: 
globs: 
alwaysApply: true
---
---
description: æ„å»ºå’Œéƒ¨ç½²æµç¨‹æŒ‡å—ï¼ŒåŒ…å«æ„å»ºå‘½ä»¤ã€éƒ¨ç½²æµç¨‹å’Œæ£€æŸ¥æ¸…å•
globs: 
  - "build.js"
  - "package.json" 
  - "tsconfig.json"
  - "manifest.json"
alwaysApply: false
---

# æ„å»ºå’Œéƒ¨ç½²

## æ„å»ºå‘½ä»¤
```bash
# ğŸš€ ç»Ÿä¸€æ„å»ºï¼ˆæ¨èï¼‰
npm run build

# åˆ†åˆ«æ„å»º
npm run build:core     # ä»…æ„å»ºæ ¸å¿ƒåº“
npm run build:plugin   # ä»…æ„å»ºæ’ä»¶
npm run build:separate # åˆ†åˆ«æ„å»ºï¼ˆä¸å«UIåˆå¹¶ï¼‰

# å¼€å‘æ¨¡å¼
npm run dev           # æ’ä»¶å¼€å‘æ¨¡å¼ï¼ˆç›‘å¬æ–‡ä»¶å˜åŒ–ï¼‰
npm run dev:core      # æ ¸å¿ƒåº“å¼€å‘æ¨¡å¼

# ä»£ç æ£€æŸ¥
npm run type-check    # TypeScriptç±»å‹æ£€æŸ¥
npm run lint          # ESLintä»£ç æ£€æŸ¥
npm run lint:fix      # è‡ªåŠ¨ä¿®å¤ESLinté—®é¢˜

# ç¯å¢ƒç®¡ç†
npm run clean         # æ¸…ç†æ„å»ºäº§ç‰©
npm run setup         # é¡¹ç›®åˆå§‹åŒ–

# æµ‹è¯•
npm run test          # è¿è¡Œæµ‹è¯•
npm run test:core     # è¿è¡Œæ ¸å¿ƒåº“æµ‹è¯•
```

## ç»Ÿä¸€æ„å»ºæµç¨‹ï¼ˆbuild.jsï¼‰
1. **ç¯å¢ƒæ¸…ç†**: æ¸…ç†`dist/`ç›®å½•
2. **æ ¸å¿ƒåº“æ„å»º**: `src/core/` â†’ `dist/core/` (TypeScriptç¼–è¯‘)
3. **æ’ä»¶æ„å»º**: `src/plugin/` â†’ `dist/plugin/` (Rollupæ‰“åŒ…)
4. **UIæ„å»º**: CSS/JSå†…è”åˆå¹¶ â†’ `dist/ui.html` (Figmaæ²™ç›’é€‚é…)
5. **èµ„æºä¼˜åŒ–**: ç”Ÿæˆå‹ç¼©ç‰ˆæœ¬çš„CSSå’ŒJSæ–‡ä»¶

## æ„å»ºäº§ç‰©è¯´æ˜
- **`dist/ui.html`**: å®Œæ•´çš„å†…è”ç‰ˆUIæ–‡ä»¶ï¼ŒåŒ…å«æ‰€æœ‰CSSå’ŒJSï¼ˆ~225KBï¼‰
- **`dist/styles.min.css`**: å‹ç¼©åçš„CSSæ–‡ä»¶ï¼ˆ~32KBï¼‰
- **`dist/scripts.min.js`**: å‹ç¼©åçš„JSæ–‡ä»¶ï¼ˆ~127KBï¼‰
- **`dist/plugin/code-standalone.js`**: æ’ä»¶ä¸»ç¨‹åº
- **`dist/core/`**: æ ¸å¿ƒåº“æ¨¡å—åŒ–æ„å»ºæ–‡ä»¶

## éƒ¨ç½²æ£€æŸ¥æ¸…å•
- [ ] TypeScriptç¼–è¯‘æ— é”™è¯¯
- [ ] ESLintæ£€æŸ¥é€šè¿‡ï¼ˆå…è®¸consoleè­¦å‘Šï¼‰
- [ ] æ„å»ºäº§ç‰©å®Œæ•´
- [ ] manifest.jsonè·¯å¾„æ­£ç¡®
- [ ] ğŸš¨ **å…³é”®**ï¼šæ£€æŸ¥JavaScriptå˜é‡æ— é‡å¤å£°æ˜
- [ ] ğŸš¨ **å…³é”®**ï¼šéªŒè¯StorageAdapteræ­£ç¡®å†…è”
- [ ] ğŸš¨ **å…³é”®**ï¼šç¡®è®¤æ‰€æœ‰èµ„æºå·²å†…è”ï¼ˆæ— å¤–éƒ¨ä¾èµ–ï¼‰

## ğŸš¨ Figmaæ’ä»¶ç‰¹æ®Šæ£€æŸ¥

### å˜é‡å£°æ˜éªŒè¯
```bash
# Windowsç¯å¢ƒæ£€æŸ¥é‡å¤å£°æ˜
findstr /n "const storageAdapter" dist\\ui.html
findstr /n "class StorageAdapter" dist\\ui.html

# åº”è¯¥åªæœ‰ä»¥ä¸‹ç»“æœï¼š
# XXXX:class StorageAdapter {        (ç±»å®šä¹‰)
# YYYY:const storageAdapter = new    (å®ä¾‹åŒ–)
```

### å†…è”èµ„æºéªŒè¯
```bash
# æ£€æŸ¥æ˜¯å¦è¿˜æœ‰å¤–éƒ¨èµ„æºå¼•ç”¨
findstr /n "src=" dist\\ui.html      # åº”è¯¥æ— ç»“æœ
findstr /n "href=" dist\\ui.html     # åº”è¯¥æ— ç»“æœï¼ˆé™¤äº†#é”šç‚¹ï¼‰
```

### æ„å»ºäº§ç‰©éªŒè¯
- ğŸ“ `dist/ui.html` å­˜åœ¨ä¸”å¤§å°çº¦225KBï¼ˆå†…è”ç‰ˆæœ¬ï¼‰
- ğŸ“ `dist/plugin/code-standalone.js` å­˜åœ¨ä¸”åŒ…å«æ’ä»¶é€»è¾‘
- ğŸ“ `dist/core/` ç›®å½•å­˜åœ¨ä¸”åŒ…å«å®Œæ•´æ¨¡å—åŒ–æ„å»ºæ–‡ä»¶
- ğŸ“ `dist/core/index.js` å’Œ `dist/core/index.d.ts` å­˜åœ¨
- ğŸ“ `dist/styles.min.css` å­˜åœ¨ä¸”å¤§å°çº¦32KB
- ğŸ“ `dist/scripts.min.js` å­˜åœ¨ä¸”å¤§å°çº¦127KB

### ğŸ¯ ç»Ÿä¸€æ„å»ºéªŒè¯
```bash
# ä¸€é”®æ„å»ºéªŒè¯
npm run build

# é¢„æœŸè¾“å‡ºï¼š
# âœ… æ¸…ç†distç›®å½•å®Œæˆ
# âœ… æ ¸å¿ƒåº“æ„å»ºå®Œæˆ  
# âœ… æ’ä»¶æ„å»ºå®Œæˆ
# âœ… CSSåˆå¹¶å®Œæˆ: ~30KB
# âœ… JavaScriptåˆå¹¶å®Œæˆ: ~113KB
# âœ… å†…è”HTMLæ„å»ºå®Œæˆ: ~205KB
# ğŸ“¦ Figmaæ’ä»¶æ²™ç›’é€‚é…: CSS + JS å·²å®Œå…¨å†…è”
```

## é—®é¢˜æ’æŸ¥
```bash
# æ£€æŸ¥TypeScripté”™è¯¯
npm run type-check

# æ£€æŸ¥ä»£ç è§„èŒƒ
npm run lint

# æ£€æŸ¥é‡å¤å£°æ˜
findstr /n "const storageAdapter" dist\\ui.html

# é‡æ–°æ„å»º
npm run clean && npm run build
```



