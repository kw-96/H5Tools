<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>渠道美术-H5延展工具</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;600;700&display=swap');
    
    /* 通知样式 */
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 12px 20px;
      background-color: #333;
      color: white;
      border-radius: 8px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      z-index: 9999;
      font-size: 14px;
      opacity: 0;
      transform: translateY(-20px);
      transition: all 0.3s ease;
    }
    
    .notification.success {
      background-color: #34c759;
    }
    
    .notification.error {
      background-color: #ff3b30;
    }
    
    .notification.warning {
      background-color: #ff9500;
    }
    
    .notification.info {
      background-color: #0071e3;
    }
    
    /* 基础样式和布局 */
    * {
      scrollbar-width: none;
      -ms-overflow-style: none;
      box-sizing: border-box;
    }
    
    ::-webkit-scrollbar {
      width: 0;
      height: 0;
      background: transparent;
    }
    
    body {
      margin: 0;
      padding: 0;
      font-family: 'Noto Sans SC', 'Source Han Sans CN', '思源黑体 CN', -apple-system, BlinkMacSystemFont, sans-serif;
      color: #1d1d1f;
      background-color: #ffffff;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      overflow-x: hidden;
    }
    
    .container {
      max-width: 100%;
      margin: 0 auto;
      overflow-x: hidden;
      height: 100vh;
      display: flex;
      flex-direction: column;
      padding-top: 46px;
      padding-bottom: 40px;
    }
    
    /* 标签页和导航 */
    .tab-container {
      display: flex;
      width: 100%;
      justify-content: space-between;
      background-color: rgba(255, 255, 255, 0.72);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      padding: 8px 0;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1000;
    }
    
    .tab {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      flex: 1;
      width: 25%;
      padding: 8px 4px;
      border-radius: 8px;
      transition: all 0.2s cubic-bezier(0.645, 0.045, 0.355, 1);
      cursor: pointer;
      color: #86868b;
    }
    
    .tab svg {
      width: 20px;
      height: 20px;
      margin-bottom: 4px;
    }
    
    .tab-label {
      font-size: 11px;
      font-weight: 500;
      margin-top: 2px;
      opacity: 0.8;
    }
    
    .tab.active {
      color: #0071e3;
    }
    
    .tab:hover {
      color: #0071e3;
      background-color: rgba(0, 113, 227, 0.05);
    }
    
    /* 内容区域 */
    .tab-content {
      display: none;
      padding: 0 16px;
      margin: 30px auto 0px;
      width: 100%;
      background-color: #ffffff;
      overflow-y: auto;
      overflow-x: hidden;
    }
    
    .tab-content.active {
      display: block;
      animation: fadeIn 0.3s ease-in-out;
      position: relative;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(5px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* 表单控件 */
    .form-group {
      margin-bottom: 14px;
    }
    
    .row-layout {
      display: flex;
      align-items: center;
      justify-content: space-between;
      width: 100%;
    }
    
    label {
      display: block;
      font-size: 14px;
      font-weight: 500;
      color: #1d1d1f;
    }
    
    .row-layout label {
      flex: 0 0 auto;
      margin: 0 16px 0 0;
      min-width: 70px;
      width: 25%;
      max-width: 90px;
    }
    
    .non-interactive-label {
      pointer-events: none;
      cursor: default;
    }
    
    /* 输入控件 */
    input[type="number"], 
    input[type="color"], 
    input[type="text"], 
    .text-input, 
    .text-area {
      width: 100%;
      padding: 10px 12px;
      font-size: 14px;
      border: 1px solid rgba(0, 0, 0, 0.1);
      border-radius: 8px;
      background-color: #ffffff;
      transition: all 0.2s;
      appearance: none;
      -webkit-appearance: none;
    }
    
    .text-area {
      min-height: 80px;
      resize: vertical;
      font-family: inherit;
      line-height: 1.5;
    }
    
    input:focus, .text-input:focus, .text-area:focus {
      outline: none;
      border-color: #0071e3;
      box-shadow: 0 0 0 4px rgba(0, 113, 227, 0.2);
    }
    
    /* 颜色选择器 */
    .color-input-group {
      display: flex;
      align-items: center;
      min-width: 120px;
      flex: 1;
    }
    
    input[type="color"] {
      width: 24px;
      height: 24px;
      padding: 0;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    
    input.color-value {
      margin-left: 8px;
      font-size: 13px;
      color: #666;
      width: 80px;
      padding: 4px 8px;
      border: 1px solid rgba(0, 0, 0, 0.1);
      border-radius: 4px;
      background-color: #ffffff;
    }
    
    /* 上传和预览组件 */
    .file-upload-btn, 
    .img-upload-wrapper {
      flex: 1;
      width: 100%;
    }
    
    .upload-btn {
      width: 100%;
      padding: 12px;
      background-color: #f5f5f7;
      border: 1px dashed rgba(0, 0, 0, 0.1);
      border-radius: 8px;
      color: #666;
      cursor: pointer;
      font-size: 14px;
      text-align: center;
      transition: all 0.2s;
      position: relative;
    }
    
    .upload-btn:hover {
      background-color: #efefef;
      border-color: rgba(0, 0, 0, 0.2);
    }
    
    /* 折叠内容区域 */
    .version-content {
      max-height: 0;
      opacity: 0;
      overflow: hidden;
      transition: all 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);
      padding-left: 24px;
    }

    .version-content.active {
      max-height: 800px;
      opacity: 1;
      padding-bottom: 15px;
    }
    
    .collapsible-content {
      max-height: 1000px;
      overflow: hidden;
      transition: max-height 0.3s ease;
    }
    
    .collapsible-content.collapsed {
      max-height: 0;
    }
    
    /* 板块和模块样式 */
    .form-section, .module {
      width: 100%;
      padding: 16px 0;
      margin-bottom: 0;
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    }
    
    /* 模块管理相关样式 */
    .module-management {
      margin-bottom: 20px;
    }
    
    /* 模块列表头部样式 */
    .module-list-header {
      display: flex;                                /* 使用弹性布局 */
      justify-content: space-between;                /* 两端对齐 */
      align-items: center;                           /* 垂直居中对齐 */
      margin: 24px 0 12px 0;                         /* 设置上下外边距 */
      padding-bottom: 8px;                           /* 底部内边距 */
      font-weight: 600;                              /* 字体加粗 */
    }
    
    .module-count {
      font-size: 14px;
      color: #86868b;
      font-weight: normal;
    }
    
    .dropdown-selector-wide {
      flex: 1;
      min-width: 200px;
      max-width: 100%;
    }
    
    .dropdown-selector-wide .section-dropdown {
      width: 100%;
    }
    
    .module-action-row {
      justify-content: center;
      margin-top: 10px;
    }
    
    .action-btn {
      background-color: #0071e3;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 10px 20px;
      font-weight: 500;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: all 0.2s;
    }
    
    .action-btn:hover {
      background-color: #0077ed;
      transform: translateY(-1px);
    }
    
    .add-module-btn {
      min-width: 150px;
    }
    
    .empty-modules-message {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 40px 20px;
      text-align: center;
      color: #86868b;
      border: 2px dashed rgba(0,0,0,0.1);
      border-radius: 10px;
      margin: 20px 0;
    }
    
    .empty-modules-message svg {
      font-size: 48px;
      margin-bottom: 16px;
      opacity: 0.5;
    }
    
    .empty-modules-message p {
      margin: 5px 0;
      font-size: 16px;
    }
    
    .empty-modules-message .hint-text {
      font-size: 14px;
      opacity: 0.7;
    }
    
    /* 模块相关样式 */
    .module {
      border: 1px solid rgba(0,0,0,0.1);
      border-radius: 10px;
      margin-bottom: 16px;
      background-color: #ffffff;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      overflow: hidden;
      transition: all 0.3s ease;
    }
    
    .module-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 16px;
      background-color: #f5f5f7;
      border-bottom: 1px solid rgba(0,0,0,0.05);
    }
    
    .module-title {
      font-weight: 600;
      font-size: 16px;
      color: #1d1d1f;
    }
    
    .module-controls {
      display: flex;
      gap: 8px;
    }
    
    .module-content {
      padding: 16px;
      transition: max-height 0.3s ease, opacity 0.2s ease;
    }
    
    .module-collapsed .module-content {
      max-height: 0;
      opacity: 0;
      padding: 0 16px;
      overflow: hidden;
    }
    
    .module-collapsed .collapse-btn i {
      transform: rotate(180deg);
    }
    
    /* 深色主题适配 - 模块管理 */
    body.dark-theme .module {
      background-color: #1d1d1f;
      border-color: rgba(255,255,255,0.1);
    }
    
    body.dark-theme .module-header {
      background-color: #2c2c2e;
      border-color: rgba(255,255,255,0.05);
    }
    
    body.dark-theme .module-title {
      color: #f5f5f7;
    }
    
    body.dark-theme .empty-modules-message {
      border-color: rgba(255,255,255,0.1);
      color: #a1a1a6;
    }
    
    .form-section:last-child {
      border-bottom: none;
    }
    
    .form-section .form-group:last-child {
      margin-bottom: 0;
    }
    
    .section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin: 0 0 16px 0;
      font-size: 14px;
      font-weight: 600;
      color: #1d1d1f;
    }
    
    .section-title {
      color: inherit;
    }
    
    /* 图片预览 */
    .img-preview-inline, 
    .preview-container {
      width: 100%;
      height: 100%;
      position: absolute;
      top: 0;
      left: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    
    .img-preview-inline {
      pointer-events: none;
      border-radius: 8px;
    }
    
    .img-preview-inline img, 
    .preview-container img, 
    .img-preview-container img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }
    
    .img-preview-btn {
      width: 100%;
      cursor: pointer;
      display: flex;
      justify-content: flex-start;
    }
    
    .img-preview-container {
      width: 80px;
      height: 80px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #f5f5f7;
      border: 1px dashed rgba(0, 0, 0, 0.2);
      position: relative;
      overflow: hidden;
      transition: all 0.2s;
    }
    
    .img-preview-container:hover {
      background-color: #efefef;
      border-color: rgba(0, 0, 0, 0.3);
    }
    
    /* 按钮和控件 */
    .control-btn {
      width: 22px;
      height: 22px;
      border-radius: 50%;
      border: 1px solid #e5e5e5;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
      font-size: 14px;
      color: #86868b;
      cursor: pointer;
      transition: all 0.2s;
      background-color: transparent;
    }
    
    .control-btn:hover {
      background-color: #f5f5f7;
    }
    
    .collapse-btn {
      transition: transform 0.3s ease, background-color 0.2s, border-color 0.2s, color 0.2s;
    }
    
    .collapse-btn svg, .chevron-icon {
      color: inherit;
      fill: currentColor;
      stroke: currentColor;
    }
    
    .collapse-btn.collapsed {
      transform: rotate(180deg);
    }
    
    .add-btn {
      margin-right: 6px;
      font-size: 14px;
      font-weight: 500;
      line-height: 1;
    }
    
    .add-btn:hover {
      background-color: rgba(0, 113, 227, 0.1);
      border-color: #0071e3;
      color: #0071e3;
    }
    
    .add-btn[onclick*="removeModule"]:hover {
      background-color: rgba(255, 59, 48, 0.1);
      border-color: #ff3b30;
      color: #ff3b30;
    }
    
    .option-controls {
      display: flex;
      align-items: center;
    }
    
    /* 模块标题和内容 */
    .module-title {
      font-size: 14px;
      font-weight: 600;
      color: #1d1d1f;
      margin-right: 4px;
      flex: 1;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    
    /* 下拉选择器 */
    .dropdown-selector {
      position: relative;
      min-width: 120px;
      max-width: 140px;
      z-index: 10;
    }
    
    .section-dropdown {
      appearance: none;
      -webkit-appearance: none;
      padding: 6px 10px;
      border-radius: 6px;
      border: 1px solid rgba(0, 0, 0, 0.15);
      font-family: inherit;
      font-size: 14px;
      font-weight: 600;
      color: #1d1d1f;
      background-color: rgba(255, 255, 255, 0.8);
      cursor: pointer;
      transition: all 0.2s ease;
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    }
    
    /* 主题切换和页脚 */
    .theme-switcher {
      margin-bottom: 20px;
    }
    
    .theme-buttons {
      display: flex;
      gap: 8px;
    }
    
    .theme-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 8px 16px;
      background-color: #f0f0f0;
      border: 1px solid rgba(0, 0, 0, 0.1);
      border-radius: 6px;
      color: #333;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .theme-btn.active {
      background-color: #0071e3;
      color: white;
      border-color: #0071e3;
    }
    
    .theme-btn:hover:not(.active) {
      background-color: #e5e5e5;
    }
    
    .page-footer {
      width: 100%;
      padding: 10px;
      background-color: rgba(255, 255, 255, 0.72);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-top: 1px solid rgba(0, 0, 0, 0.1);
      position: fixed;
      bottom: 0;
      left: 0;
      z-index: 100;
    }
    
    .version-info {
      display: flex;
      justify-content: space-between;
      width: 100%;
      color: #86868b;
      font-size: 13px;
    }
    
    /* 奖品网格 */
    .prize-grid {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      gap: 8px;
      margin-top: 10px;
    }
    
    .grid-item {
      flex: 0 0 calc(33.333% - 6px);
    }
    
    .img-upload-container {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    .grid-btn {
      width: 100%;
      aspect-ratio: 1/1;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #f5f5f7;
      border: 1px dashed rgba(0, 0, 0, 0.2);
      border-radius: 6px;
      cursor: pointer;
      position: relative;
      overflow: hidden;
      padding: 0;
      transition: all 0.2s;
    }
    
    .grid-btn:hover {
      background-color: #efefef;
      border-color: rgba(0, 0, 0, 0.3);
    }
    
    .upload-icon, .upload-icon-text, .upload-icon-inline {
      font-size: 20px;
      color: #86868b;
    }
    
    .upload-icon {
      position: absolute;
      z-index: 1;
    }
    
    .upload-icon-text, .upload-icon-inline {
      font-size: 24px;
    }
    
    .prize-label {
      margin-top: 4px;
      font-size: 12px;
      color: #86868b;
      text-align: center;
      width: 100%;
    }
    
    /* 创建按钮 */
    .create-btn-container {
      display: flex;
      justify-content: center;
      padding: 0 0 24px 0;
      width: 100%;
      margin: 0 auto;
    }
    
    .button-group {
      display: flex;
      gap: 12px;
      margin-top: 24px;
      justify-content: center;
      width: 100%;
      max-width: 320px;
    }
    
    button {
      padding: 10px 20px;
      font-size: 14px;
      font-weight: 500;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    button#create {
      background-color: #0071e3;
      color: white;
      min-width: 150px;
    }
    
    button#create:hover {
      background-color: #0077ed;
      transform: translateY(-1px);
      box-shadow: 0 2px 5px rgba(0, 113, 227, 0.2);
    }
    
    button#cancel {
      background-color: #f5f5f7;
      color: #1d1d1f;
    }
    
    button#cancel:hover {
      background-color: #e8e8ed;
    }
    
    /* 深色主题适配 */
    body.dark-theme {
      color: #f5f5f7;
      background-color: #1d1d1f;
    }
    
    body.dark-theme .tab-container {
      background-color: rgba(30, 30, 32, 0.72);
      border-bottom-color: rgba(255, 255, 255, 0.1);
    }
    
    body.dark-theme .tab:hover {
      background-color: rgba(255, 255, 255, 0.05);
    }
    
    body.dark-theme .tab-content {
      background-color: #1d1d1f;
    }
    
    body.dark-theme .form-section,
    body.dark-theme .module {
      border-bottom-color: rgba(255, 255, 255, 0.1);
    }
    
    body.dark-theme .section-header,
    body.dark-theme .section-title,
    body.dark-theme label,
    body.dark-theme .module-title {
      color: #f5f5f7;
    }
    
    body.dark-theme input[type="number"],
    body.dark-theme input[type="text"],
    body.dark-theme .text-input,
    body.dark-theme .text-area {
      background-color: #2c2c2e;
      border-color: rgba(255, 255, 255, 0.1);
      color: #f5f5f7;
    }
    
    body.dark-theme input:focus,
    body.dark-theme .text-input:focus,
    body.dark-theme .text-area:focus {
      border-color: #0071e3;
      box-shadow: 0 0 0 4px rgba(0, 113, 227, 0.15);
    }
    
    body.dark-theme .upload-btn,
    body.dark-theme .grid-btn,
    body.dark-theme .img-preview-container,
    body.dark-theme .add-btn,
    body.dark-theme .theme-btn:not(.active),
    body.dark-theme button#cancel {
      background-color: #2c2c2e;
      border-color: rgba(255, 255, 255, 0.1);
      color: #f5f5f7;
    }
    
    body.dark-theme .upload-btn:hover,
    body.dark-theme .grid-btn:hover,
    body.dark-theme .img-preview-container:hover,
    body.dark-theme .theme-btn:hover:not(.active),
    body.dark-theme button#cancel:hover {
      background-color: #3a3a3c;
      border-color: rgba(255, 255, 255, 0.2);
    }
    
    body.dark-theme .control-btn {
      border-color: #3a3a3c;
      color: #a1a1a6;
    }
    
    body.dark-theme .control-btn:hover {
      background-color: #2c2c2e;
    }
    
    body.dark-theme .add-btn:hover {
      background-color: rgba(0, 113, 227, 0.2);
      border-color: #0071e3;
      color: #0071e3;
    }
    
    body.dark-theme .add-btn[onclick*="removeModule"]:hover {
      background-color: rgba(255, 69, 58, 0.1);
      border-color: #ff453a;
      color: #ff453a;
    }
    
    body.dark-theme .section-dropdown {
      background-color: rgba(44, 44, 46, 0.8);
      border-color: rgba(255, 255, 255, 0.15);
      color: #f5f5f7;
    }
    
    body.dark-theme .page-footer {
      background-color: rgba(30, 30, 32, 0.72);
      border-top-color: rgba(255, 255, 255, 0.1);
    }
    
    body.dark-theme .prize-label,
    body.dark-theme .upload-icon,
    body.dark-theme .upload-icon-text,
    body.dark-theme .upload-icon-inline {
      color: #a1a1a6;
    }
  </style>
</head>
<body>
  <!-- 主容器 -->
  <div class="container">
    <!-- 标签页容器 -->
    <div class="tab-container">
      <!-- 创建原型标签页 -->
      <div class="tab active" data-tab="prototype">
        <!-- SVG图标：创建原型 -->
        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path d="M9.4375 8C10.3004 8 11 8.69956 11 9.5625V18.4375C11 19.3004 10.3004 20 9.4375 20H1.5625C0.699555 20 0 19.3004 0 18.4375V9.5625C0 8.69956 0.699555 8 1.5625 8H9.4375Z" />
          <path d="M18.4375 8C19.3004 8 20 8.69956 20 9.5625V18.4375C20 19.3004 19.3004 20 18.4375 20H14.5625C13.6996 20 13 19.3004 13 18.4375V9.5625C13 8.69956 13.6996 8 14.5625 8H18.4375Z" />
          <path d="M18.4375 0C19.3004 0 20 0.699555 20 1.5625V4.6875C20 5.55044 19.3004 6.25 18.4375 6.25H1.5625C0.699555 6.25 0 5.55044 0 4.6875V1.5625C0 0.699555 0.699555 0 1.5625 0H18.4375Z" />
        </svg>
        <span class="tab-label">创建原型</span>
      </div>
      <!-- 延展渠道标签页 -->
      <div class="tab" data-tab="extension">
        <!-- SVG图标：延展渠道 -->
        <svg width="20" height="20" viewBox="0 0 18 18" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path d="M1.6875 3.09375V7.25175H0V3.09375C0 2.27324 0.325948 1.48633 0.906138 0.906138C1.48633 0.325948 2.27324 0 3.09375 0H7.25175V1.6875H3.09375C2.3175 1.6875 1.6875 2.3175 1.6875 3.09375ZM16.3125 3.09375V7.25175H18V3.09375C18 2.27324 17.6741 1.48633 17.0939 0.906138C16.5137 0.325948 15.7268 0 14.9063 0H10.7483V1.6875H14.9063C14.9738 1.6875 15.0413 1.692 15.1054 1.701L11.3175 5.49113L12.51 6.68363L16.3001 2.89462C16.3091 2.95988 16.3136 3.02625 16.3136 3.09375H16.3125ZM7.26638 11.9273L2.89462 16.299C2.95875 16.308 3.02625 16.3136 3.09375 16.3136H7.25175V18H3.09375C2.27324 18 1.48633 17.6741 0.906138 17.0939C0.325948 16.5137 0 15.7268 0 14.9063V10.7471H1.6875V14.9063C1.6875 14.9738 1.692 15.039 1.701 15.1043L6.07275 10.7325L7.26525 11.925L7.26638 11.9273ZM16.3125 14.9063C16.3125 15.6836 15.6825 16.3125 14.9063 16.3125H10.7483V18H14.9063C15.7268 18 16.5137 17.6741 17.0939 17.0939C17.6741 16.5137 18 15.7268 18 14.9063V10.7483H16.3125V14.9074V14.9063Z" />
        </svg>
        <span class="tab-label">延展渠道</span>
      </div>
      <!-- 工具集标签页 -->
      <div class="tab" data-tab="tools">
        <!-- SVG图标：工具集 -->
        <svg width="20" height="20" viewBox="0 0 18 21" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path d="M9.0211 0.000215872C8.85591 -0.00344549 8.69292 0.0395296 8.55 0.124432L0.450001 4.91307C0.313036 4.99406 0.199328 5.11059 0.120328 5.25091C0.0413283 5.39123 -0.000174042 5.5504 5.4908e-07 5.71237V15.2896C-0.000174121 15.4516 0.0413281 15.6108 0.120328 15.7511C0.199328 15.8914 0.313036 16.008 0.450001 16.0889L8.54121 20.8722C8.54449 20.8742 8.54669 20.8774 8.55 20.8794C8.55608 20.8831 8.56315 20.8848 8.56934 20.8884C8.62739 20.9204 8.68869 20.9457 8.75215 20.964C8.76179 20.9667 8.77056 20.9707 8.78027 20.973C8.85101 20.9909 8.92361 21 8.99649 21H9H9.00352C9.07521 20.9997 9.14662 20.9906 9.21621 20.973C9.22527 20.9709 9.23358 20.9682 9.24258 20.9658H9.2461C9.31219 20.9463 9.37589 20.9191 9.43594 20.8848C9.44029 20.8822 9.4457 20.882 9.45 20.8794L17.55 16.0871C17.829 15.9212 18 15.6158 18 15.2932V5.70877V5.70697C17.9994 5.62978 17.9894 5.55297 17.9701 5.47834C17.9695 5.47594 17.969 5.47354 17.9684 5.47114C17.9677 5.46876 17.9673 5.46632 17.9666 5.46394C17.9469 5.39105 17.9186 5.32091 17.8822 5.25511L17.8805 5.25331L17.8787 5.24971C17.7998 5.10996 17.6865 4.99387 17.55 4.91307L9.45 0.124432C9.31946 0.0468548 9.17197 0.00413969 9.0211 0.000215872ZM9 1.98588L15.3 5.71237L8.55 9.6999C8.271 9.86581 8.1 10.1692 8.1 10.501V18.4833L1.8 14.7586V6.24344L9 1.98588ZM16 8.5V15L11.5 17.5V11L16 8.5Z" />
        </svg>
        <span class="tab-label">工具集</span>
      </div>
      <!-- 设置标签页 -->
      <div class="tab" data-tab="settings">
        <!-- SVG图标：设置 -->
        <svg width="20" height="20" viewBox="0 0 18 18" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M9 5.375C9.96141 5.375 10.8837 5.7567 11.5635 6.43652C12.2433 7.11634 12.625 8.03859 12.625 9C12.625 9.96141 12.2433 10.8837 11.5635 11.5635C10.8837 12.2433 9.96141 12.625 9 12.625C8.52396 12.625 8.05211 12.5308 7.6123 12.3486C7.17272 12.1665 6.77299 11.8999 6.43652 11.5635C6.10005 11.227 5.83354 10.8273 5.65137 10.3877C5.46919 9.94789 5.375 9.47604 5.375 9C5.375 8.52396 5.46919 8.05211 5.65137 7.6123C5.83354 7.17272 6.10005 6.773 6.43652 6.43652C6.77299 6.10005 7.17272 5.83354 7.6123 5.65137C8.05211 5.46919 8.52396 5.375 9 5.375ZM9 6.625C8.37011 6.625 7.76571 6.87491 7.32031 7.32031C6.87491 7.76571 6.625 8.37011 6.625 9C6.625 9.62989 6.87491 10.2343 7.32031 10.6797C7.76571 11.1251 8.37011 11.375 9 11.375C9.31189 11.375 9.62103 11.3137 9.90918 11.1943C10.1972 11.075 10.4592 10.9002 10.6797 10.6797C10.9002 10.4592 11.075 10.1972 11.1943 9.90918C11.3137 9.62103 11.375 9.31189 11.375 9C11.375 8.68811 11.3137 8.37897 11.1943 8.09082C11.075 7.80276 10.9002 7.5408 10.6797 7.32031C10.4592 7.09983 10.1972 6.92502 9.90918 6.80566C9.62103 6.68631 9.31189 6.625 9 6.625Z" />
          <path fill-rule="evenodd" clip-rule="evenodd" d="M11.9033 0.875C13.0982 0.875123 14.1924 1.5455 14.7363 2.6084L17.2627 7.55176C17.7277 8.46176 17.7277 9.53924 17.2627 10.4482L14.7363 15.3916C14.4696 15.9134 14.0634 16.3514 13.5635 16.6572C13.0637 16.963 12.4892 17.1251 11.9033 17.125H6.15039C5.56895 17.1249 4.99815 16.9655 4.50098 16.6641C4.00384 16.3626 3.59895 15.9305 3.33008 15.415L0.75 10.4717C0.512884 10.0173 0.388672 9.5125 0.388672 9C0.388672 8.4875 0.512884 7.98266 0.75 7.52832L3.33008 2.58398C3.59902 2.06878 4.00399 1.63721 4.50098 1.33594C4.99814 1.03464 5.56905 0.874986 6.15039 0.875H11.9033ZM6.15039 2.125C5.43044 2.125 4.7705 2.52516 4.43848 3.16309L1.8584 8.10645C1.71432 8.38235 1.63867 8.68874 1.63867 9C1.63867 9.31126 1.71432 9.61765 1.8584 9.89355L4.43848 14.8369C4.60171 15.1498 4.84762 15.4117 5.14941 15.5947C5.45122 15.7777 5.79746 15.875 6.15039 15.875H11.9033C12.6291 15.8749 13.2931 15.469 13.623 14.8232L16.1504 9.87891C16.2894 9.60685 16.3613 9.30553 16.3613 9C16.3613 8.69447 16.2894 8.39315 16.1504 8.12109L13.623 3.17676C13.4611 2.86011 13.2145 2.59478 12.9111 2.40918C12.6077 2.2236 12.259 2.12494 11.9033 2.125H6.15039Z" />
        </svg>
        <span class="tab-label">设置</span>
      </div>
    </div>

    <!-- 创建原型内容 -->
    <div class="tab-content active" id="prototype-content">
      <!-- 页面基础设置板块 -->
      <div class="form-section">
        <div class="form-group row-layout">
          <label class="non-interactive-label">页面底色</label>
          <div class="color-input-group">
            <input type="color" id="pageColor" value="#D9D9D9">
            <input type="text" class="color-value" value="#D9D9D9" maxlength="7">
          </div>
        </div>
        
        <div class="form-group row-layout">
          <label class="non-interactive-label">页面背景</label>
          <div class="file-upload-btn">
            <input type="file" id="pageBackground" accept="image/*" style="display:none">
            <button class="upload-btn" onclick="document.getElementById('pageBackground').click()">点击上传</button>
          </div>
        </div>
      </div>
      
      <!-- 页面内容板块 -->
      <div class="form-section">
        <!-- 头图 -->
        <div class="form-group row-layout">
          <label class="non-interactive-label">头图</label>
          <div class="file-upload-btn">
            <input type="file" id="headerImage" accept="image/*" style="display:none">
            <button class="upload-btn" onclick="document.getElementById('headerImage').click()">点击上传</button>
          </div>
        </div>
        
        <!-- 标题 -->
        <div class="form-group row-layout">
          <label class="non-interactive-label">标题</label>
          <div class="file-upload-btn">
            <input type="file" id="titleUpload" accept="image/*" style="display:none">
            <button class="upload-btn" onclick="document.getElementById('titleUpload').click()">点击上传</button>
          </div>
        </div>
      </div>
      
      <!-- 游戏信息板块 -->
      <div class="form-section">
        <!-- 游戏信息板块标题 -->
        <div class="section-header">
          <div class="dropdown-selector">
            <select id="buttonVersionSelect" class="section-dropdown">
              <option value="imageButton">游戏信息-带icon版</option>
              <option value="singleButton">游戏信息-单按钮版</option>
              <option value="doubleButton">游戏信息-双按钮版</option>
            </select>
          </div>
          <div class="option-controls">
            <button class="control-btn collapse-btn" data-target="buttonVersionContent">
              <svg width="12" height="7" viewBox="0 0 16 11" class="chevron-icon">
                <path d="M0.130121 2.33086L7.44223 9.90667C7.67195 10.1374 8.03601 10.151 8.28153 9.94739L8.32611 9.90667L15.8682 2.3312C15.8992 2.29996 15.9167 2.25768 15.9167 2.21361V0.910808C15.9167 0.81876 15.8421 0.744141 15.75 0.744141C15.7057 0.744141 15.6632 0.7618 15.6319 0.793213L7.90908 8.54978L0.369491 0.801243C0.3053 0.735272 0.199782 0.73383 0.133811 0.798022C0.101565 0.829398 0.083374 0.87248 0.083374 0.917472V2.21512C0.083374 2.2583 0.100133 2.29979 0.130121 2.33086Z"/>
              </svg>
            </button>
          </div>
        </div>
        
        <!-- 按钮内容容器 -->
        <div id="buttonVersionContent" class="collapsible-content">
          <!-- 游戏icon版内容 (默认显示) -->
          <div class="version-content active" id="imageButtonContent">
            <div class="form-group row-layout">
              <label class="non-interactive-label">游戏icon</label>
              <div class="img-upload-wrapper">
                <input type="file" id="gameIconUpload" accept="image/*" class="game-icon-upload" style="display:none">
                <div class="img-preview-btn" onclick="document.getElementById('gameIconUpload').click()">
                  <div class="img-preview-container" id="gameIconPreview">
                    <span class="upload-icon-text">+</span>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-group row-layout">
              <label for="gameNameInput">游戏名称</label>
              <input type="text" id="gameNameInput" class="text-input" placeholder="请输入游戏名称">
            </div>

            <div class="form-group row-layout">
              <label for="gameCopyInput">文案</label>
              <textarea id="gameCopyInput" class="text-area" placeholder="请输入游戏宣传文案"></textarea>
            </div>
            
            <div class="form-group row-layout">
              <label class="non-interactive-label">文字颜色</label>
              <div class="color-input-group">
                <input type="color" id="btnTextColor" value="#FFFFFF">
                <input type="text" class="color-value" value="#FFFFFF" maxlength="7">
              </div>
            </div>

            <div class="form-group row-layout">
              <label for="buttonTextInput">按钮文案</label>
              <input type="text" id="buttonTextInput" class="text-input" placeholder="请输入按钮文案">
            </div>

            <div class="form-group row-layout">
              <label class="non-interactive-label">按钮底</label>
              <div class="file-upload-btn">
                <input type="file" id="btnImageUpload" accept="image/*" style="display:none">
                <button class="upload-btn" onclick="document.getElementById('btnImageUpload').click()">点击上传</button>
              </div>
            </div>

          </div>
          
          <!-- 单按钮版内容 -->
          <div class="version-content" id="singleButtonContent">
            <div class="form-group row-layout">
              <label class="non-interactive-label">按钮样式</label>
              <div class="file-upload-btn">
                <input type="file" id="moduleUpload" accept="image/*" style="display:none">
                <button class="upload-btn wide-btn" onclick="document.getElementById('moduleUpload').click()">点击上传</button>
              </div>
            </div>
          </div>
          
          <!-- 双按钮版内容 -->
          <div class="version-content" id="doubleButtonContent">
            <div class="form-group row-layout">
              <label class="non-interactive-label">左侧按钮</label>
              <div class="file-upload-btn">
                <input type="file" id="leftBtnUpload" accept="image/*" style="display:none">
                <button class="upload-btn" onclick="document.getElementById('leftBtnUpload').click()">点击上传</button>
              </div>
            </div>
            
            <div class="form-group row-layout">
              <label class="non-interactive-label">右侧按钮</label>
              <div class="file-upload-btn">
                <input type="file" id="rightBtnUpload" accept="image/*" style="display:none">
                <button class="upload-btn" onclick="document.getElementById('rightBtnUpload').click()">点击上传</button>
              </div>
            </div>
            
            <div class="form-group row-layout">
              <label for="btnSpacing">按钮间距</label>
              <input type="number" id="btnSpacing" value="10" min="0" max="50" class="number-input">
            </div>
          </div>
          
        </div>
      </div>

      <!-- 模块管理区域 -->
      <div class="form-section module-management">
        <!-- 模块选择和添加区域 -->
        <div class="section-header">
          <span class="section-title">自定义模块</span>
        </div>
        <div class="module-selection-content">
          <div class="form-group row-layout">
            <label for="moduleTypeSelect">模块类型</label>
            <div class="dropdown-selector-wide">
              <select id="moduleTypeSelect" class="section-dropdown">
                <option value="lotteryModule">九宫格抽奖</option>
                <option value="signInModule">每日签到</option>
                <option value="collectModule">集卡活动</option>
                <option value="activityRules">活动内容</option>
              </select>
            </div>
          </div>
          <div class="form-group row-layout module-action-row">
            <button id="addModuleBtn" class="action-btn add-module-btn">
              添加模块
            </button>
          </div>
        </div>
        
        <!-- 已添加模块列表 -->
        <div class="module-list-header">
          <span>已添加模块</span>
          <div class="module-count"><span id="moduleCounter">0</span> 个模块</div>
        </div>
        
        <div id="modulesContainer">
          <!-- 模块将动态添加到此处 -->
          <div class="empty-modules-message" id="emptyModulesMessage">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" viewBox="0 0 16 16" style="margin-bottom: 16px; opacity: 0.5;">
              <path d="M7.752.066a.5.5 0 0 1 .496 0l3.75 2.143a.5.5 0 0 1 .252.434v3.995l3.498 2A.5.5 0 0 1 16 9.07v4.286a.5.5 0 0 1-.252.434l-3.75 2.143a.5.5 0 0 1-.496 0l-3.502-2-3.502 2a.5.5 0 0 1-.496 0l-3.75-2.143A.5.5 0 0 1 0 13.357V9.071a.5.5 0 0 1 .252-.434L3.75 6.638V2.643a.5.5 0 0 1 .252-.434L7.752.066ZM4.25 7.504 1.508 9.071l2.742 1.567 2.742-1.567L4.25 7.504ZM7.5 9.933l-2.75 1.571v3.134l2.75-1.571V9.933Zm1 3.134 2.75 1.571v-3.134L8.5 9.933v3.134Zm.508-3.996 2.742 1.567 2.742-1.567-2.742-1.567-2.742 1.567Zm2.242-2.433V3.504L8.5 5.076V8.21l2.75-1.572ZM7.5 8.21V5.076L4.75 3.504v3.134L7.5 8.21ZM5.258 2.643 8 4.21l2.742-1.567L8 1.076 5.258 2.643ZM15 9.933l-2.75 1.571v3.134L15 13.067V9.933ZM3.75 14.638v-3.134L1 9.933v3.134l2.75 1.571Z"/>
            </svg>
            <p>尚未添加任何模块</p>
            <p class="hint-text">请从上方选择模块类型并添加</p>
          </div>
        </div>
      </div>

      <!-- 模块模板库 (隐藏) -->
      <div id="moduleTemplates" style="display: none;">
        <!-- 固定模块-九宫格抽奖模板 -->
        <div class="module-template" id="lotteryModuleTemplate">
          <div class="module-header">
            <div class="module-title">九宫格抽奖</div>
            <div class="module-controls">
              <button class="control-btn move-up-btn" title="上移">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z"/>
                </svg>
              </button>
              <button class="control-btn move-down-btn" title="下移">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1z"/>
                </svg>
              </button>
              <button class="control-btn collapse-btn" title="展开/收起">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
                </svg>
              </button>
              <button class="control-btn delete-btn" title="删除">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                  <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
                  <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
                </svg>
              </button>
            </div>
          </div>
          <div class="module-content">
            <!-- 大标题 -->
            <div class="form-group row-layout">
              <label class="non-interactive-label">大标题</label>
              <input type="text" class="text-input big-title-input" placeholder="请输入大标题文本">
            </div>
            
            <!-- 标题背景 -->
            <div class="form-group row-layout">
              <label class="non-interactive-label">大标题背景</label>
              <div class="file-upload-btn">
                <input type="file" class="derived-item-upload" accept="image/*" style="display:none">
                <button class="upload-btn" onclick="this.previousElementSibling.click()">点击上传</button>
              </div>
            </div>
            
            <!-- 九宫格背景 -->
            <div class="form-group row-layout">
              <label class="non-interactive-label">九宫格背景</label>
              <div class="file-upload-btn">
                <input type="file" class="nine-grid-bg" accept="image/*" style="display:none">
                <button class="upload-btn" onclick="this.previousElementSibling.click()">点击上传</button>
              </div>
            </div>

            <!-- 抽奖按钮 -->
            <div class="form-group row-layout">
              <label class="non-interactive-label">抽奖按钮</label>
              <div class="file-upload-btn">
                <input type="file" class="draw-btn" accept="image/*" style="display:none">
                <button class="upload-btn" onclick="this.previousElementSibling.click()">点击上传</button>
              </div>
            </div>

            <!-- 奖品背景 -->
            <div class="form-group row-layout">
              <label class="non-interactive-label">奖品背景</label>
              <div class="file-upload-btn">
                <input type="file" class="prize-bg" accept="image/*" style="display:none">
                <button class="upload-btn" onclick="this.previousElementSibling.click()">点击上传</button>
              </div>
            </div>
            
            <!-- 奖品图 -->
            <div class="form-group row-layout">
              <label class="non-interactive-label">奖品图</label>
              <div class="prize-grid">
                <div class="grid-item">
                  <div class="img-upload-container">
                    <input type="file" accept="image/*" class="prize-upload" style="display:none">
                    <button class="grid-btn" onclick="this.previousElementSibling.click()">
                      <div class="preview-container"></div>
                      <span class="upload-icon">+</span>
                    </button>
                    <div class="prize-label">奖品01</div>
                  </div>
                </div>
                <div class="grid-item">
                  <div class="img-upload-container">
                    <input type="file" accept="image/*" class="prize-upload" style="display:none">
                    <button class="grid-btn" onclick="this.previousElementSibling.click()">
                      <div class="preview-container"></div>
                      <span class="upload-icon">+</span>
                    </button>
                    <div class="prize-label">奖品02</div>
                  </div>
                </div>
                <div class="grid-item">
                  <div class="img-upload-container">
                    <input type="file" accept="image/*" class="prize-upload" style="display:none">
                    <button class="grid-btn" onclick="this.previousElementSibling.click()">
                      <div class="preview-container"></div>
                      <span class="upload-icon">+</span>
                    </button>
                    <div class="prize-label">奖品03</div>
                  </div>
                </div>
                <div class="grid-item">
                  <div class="img-upload-container">
                    <input type="file" accept="image/*" class="prize-upload" style="display:none">
                    <button class="grid-btn" onclick="this.previousElementSibling.click()">
                      <div class="preview-container"></div>
                      <span class="upload-icon">+</span>
                    </button>
                    <div class="prize-label">奖品04</div>
                  </div>
                </div>
                <div class="grid-item">
                  <div class="img-upload-container">
                    <input type="file" accept="image/*" class="prize-upload" style="display:none">
                    <button class="grid-btn" onclick="this.previousElementSibling.click()">
                      <div class="preview-container"></div>
                      <span class="upload-icon">+</span>
                    </button>
                    <div class="prize-label">奖品05</div>
                  </div>
                </div>
                <div class="grid-item">
                  <div class="img-upload-container">
                    <input type="file" accept="image/*" class="prize-upload" style="display:none">
                    <button class="grid-btn" onclick="this.previousElementSibling.click()">
                      <div class="preview-container"></div>
                      <span class="upload-icon">+</span>
                    </button>
                    <div class="prize-label">奖品06</div>
                  </div>
                </div>
                <div class="grid-item">
                  <div class="img-upload-container">
                    <input type="file" accept="image/*" class="prize-upload" style="display:none">
                    <button class="grid-btn" onclick="this.previousElementSibling.click()">
                      <div class="preview-container"></div>
                      <span class="upload-icon">+</span>
                    </button>
                    <div class="prize-label">奖品07</div>
                  </div>
                </div>
                <div class="grid-item">
                  <div class="img-upload-container">
                    <input type="file" accept="image/*" class="prize-upload" style="display:none">
                    <button class="grid-btn" onclick="this.previousElementSibling.click()">
                      <div class="preview-container"></div>
                      <span class="upload-icon">+</span>
                    </button>
                    <div class="prize-label">奖品08</div>
                  </div>
                </div>
                <div class="grid-item">
                  <div class="img-upload-container">
                    <input type="file" accept="image/*" class="prize-upload" style="display:none">
                    <button class="grid-btn" onclick="this.previousElementSibling.click()">
                      <div class="preview-container"></div>
                      <span class="upload-icon">+</span>
                    </button>
                    <div class="prize-label">谢谢参与</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- 固定模块-签到模板 -->
        <div class="module-template" id="signInModuleTemplate">
          <div class="module-header">
            <div class="module-title">每日签到</div>
            <div class="module-controls">
              <button class="control-btn move-up-btn" title="上移">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z"/>
                </svg>
              </button>
              <button class="control-btn move-down-btn" title="下移">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1z"/>
                </svg>
              </button>
              <button class="control-btn collapse-btn" title="展开/收起">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
                </svg>
              </button>
              <button class="control-btn delete-btn" title="删除">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                  <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
                  <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
                </svg>
              </button>
            </div>
          </div>
          <div class="module-content">
            <!-- 签到标题 -->
            <div class="form-group row-layout">
              <label class="non-interactive-label">标题图片</label>
              <div class="file-upload-btn">
                <input type="file" class="sign-in-title-upload" accept="image/*" style="display:none">
                <button class="upload-btn" onclick="this.previousElementSibling.click()">点击上传</button>
              </div>
            </div>
            
            <!-- 签到背景 -->
            <div class="form-group row-layout">
              <label class="non-interactive-label">背景图片</label>
              <div class="file-upload-btn">
                <input type="file" class="sign-in-bg-upload" accept="image/*" style="display:none">
                <button class="upload-btn" onclick="this.previousElementSibling.click()">点击上传</button>
              </div>
            </div>
            
            <!-- 签到天数 -->
            <div class="form-group row-layout">
              <label>签到天数</label>
              <input type="number" class="days-count" value="7" min="3" max="31" class="number-input">
            </div>
            
            <!-- 日期图标 -->
            <div class="form-group row-layout">
              <label class="non-interactive-label">日期图标</label>
              <div class="file-upload-btn">
                <input type="file" class="day-icon-upload" accept="image/*" style="display:none">
                <button class="upload-btn" onclick="this.previousElementSibling.click()">点击上传</button>
              </div>
            </div>
            
            <!-- 签到按钮 -->
            <div class="form-group row-layout">
              <label class="non-interactive-label">签到按钮</label>
              <div class="file-upload-btn">
                <input type="file" class="sign-in-btn-upload" accept="image/*" style="display:none">
                <button class="upload-btn" onclick="this.previousElementSibling.click()">点击上传</button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- 固定模块-集卡模板 -->
        <div class="module-template" id="collectModuleTemplate">
          <div class="module-header">
            <div class="module-title">集卡活动</div>
            <div class="module-controls">
              <button class="control-btn move-up-btn" title="上移">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z"/>
                </svg>
              </button>
              <button class="control-btn move-down-btn" title="下移">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1z"/>
                </svg>
              </button>
              <button class="control-btn collapse-btn" title="展开/收起">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
                </svg>
              </button>
              <button class="control-btn delete-btn" title="删除">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                  <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
                  <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
                </svg>
              </button>
            </div>
          </div>
          <div class="module-content">
            <!-- 集卡标题 -->
            <div class="form-group row-layout">
              <label class="non-interactive-label">集卡标题</label>
              <div class="file-upload-btn">
                <input type="file" class="collect-title-upload" accept="image/*" style="display:none">
                <button class="upload-btn" onclick="this.previousElementSibling.click()">点击上传</button>
              </div>
            </div>
            
            <!-- 集卡背景 -->
            <div class="form-group row-layout">
              <label class="non-interactive-label">背景图片</label>
              <div class="file-upload-btn">
                <input type="file" class="collect-bg-upload" accept="image/*" style="display:none">
                <button class="upload-btn" onclick="this.previousElementSibling.click()">点击上传</button>
              </div>
            </div>
            
            <!-- 卡片数量 -->
            <div class="form-group row-layout">
              <label>卡片数量</label>
              <input type="number" class="cards-count" value="5" min="3" max="12" class="number-input">
            </div>
            
            <!-- 卡片样式 -->
            <div class="form-group row-layout">
              <label class="non-interactive-label">卡片样式</label>
              <div class="radio-group row-layout">
                <div class="radio-item">
                  <input type="radio" name="cardStyle" value="style1" checked>
                  <label>方形</label>
                </div>
                <div class="radio-item">
                  <input type="radio" name="cardStyle" value="style2">
                  <label>圆角</label>
                </div>
                <div class="radio-item">
                  <input type="radio" name="cardStyle" value="style3">
                  <label>自定义</label>
                </div>
              </div>
            </div>
            
            <!-- 卡片背景 -->
            <div class="form-group row-layout">
              <label class="non-interactive-label">卡片背景</label>
              <div class="file-upload-btn">
                <input type="file" class="card-bg-upload" accept="image/*" style="display:none">
                <button class="upload-btn" onclick="this.previousElementSibling.click()">点击上传</button>
              </div>
            </div>
            
            <!-- 合成按钮 -->
            <div class="form-group row-layout">
              <label class="non-interactive-label">合成按钮</label>
              <div class="file-upload-btn">
                <input type="file" class="combine-button-upload" accept="image/*" style="display:none">
                <button class="upload-btn" onclick="this.previousElementSibling.click()">点击上传</button>
              </div>
            </div>
          </div>
        </div>

        <!-- 活动内容模板 -->
        <div class="module-template" id="activityRulesTemplate">
          <div class="module-header">
            <div class="module-title">活动内容</div>
            <div class="module-controls">
              <button class="control-btn move-up-btn" title="上移">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z"/>
                </svg>
              </button>
              <button class="control-btn move-down-btn" title="下移">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1z"/>
                </svg>
              </button>
              <button class="control-btn collapse-btn" title="展开/收起">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
                </svg>
              </button>
              <button class="control-btn delete-btn" title="删除">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                  <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
                  <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
                </svg>
              </button>
            </div>
          </div>
          <div class="module-content">
            <!-- 大标题文案 -->
            <div class="form-group row-layout">
              <label>大标题</label>
              <input type="text" class="activity-rule-title-input text-input" placeholder="请输入大标题文本">
            </div>
            
            <!-- 大标题背景 -->
            <div class="form-group row-layout">
              <label class="non-interactive-label">大标题背景</label>
              <div class="file-upload-btn">
                <input type="file" class="activity-rule-item-upload" accept="image/*" style="display:none" onchange="previewImage(this, this.nextElementSibling.querySelector('.img-preview-inline'))">
                <button class="upload-btn" onclick="this.previousElementSibling.click()">
                  <div class="img-preview-inline">
                    <span class="upload-icon-inline">+</span>
                  </div>
                </button>
              </div>
            </div>

            <!-- 小标题文案 -->
            <div class="form-group row-layout">
              <label>小标题</label>
              <input type="text" class="small-title-input text-input" placeholder="请输入小标题文本">
            </div>

            <!-- 小标题背景 -->
            <div class="form-group row-layout">
              <label class="non-interactive-label">小标题背景</label>
              <div class="file-upload-btn">
                <input type="file" class="small-title-upload" accept="image/*" style="display:none" onchange="previewImage(this, this.nextElementSibling.querySelector('.img-preview-inline'))">
                <button class="upload-btn" onclick="this.previousElementSibling.click()">
                  <div class="img-preview-inline">
                    <span class="upload-icon-inline">+</span>
                  </div>
                </button>
              </div>
            </div>
            
            <!-- 文字 -->
            <div class="form-group row-layout">
              <label>正文</label>
              <textarea class="activity-rule-text-input text-area" placeholder="请输入活动正文内容"></textarea>
            </div>

            <!-- 图片 -->
            <div class="form-group row-layout">
              <label class="non-interactive-label">图片</label>
              <div class="file-upload-btn">
                <input type="file" class="activity-rule-text-upload" accept="image/*" style="display:none">
                <button class="upload-btn text-upload-btn" onclick="this.previousElementSibling.click()">点击上传</button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- 更多模板可继续添加 -->
      </div>

      <!-- 活动规则板块 -->
      <div class="form-section">
        <!-- 活动规则标题 -->
        <div class="section-header">
          <span class="section-title">活动规则</span>
          <div class="option-controls">
            <button class="control-btn collapse-btn" data-target="rulesContent">
              <svg width="12" height="7" viewBox="0 0 16 11" class="chevron-icon">
                <path d="M0.130121 2.33086L7.44223 9.90667C7.67195 10.1374 8.03601 10.151 8.28153 9.94739L8.32611 9.90667L15.8682 2.3312C15.8992 2.29996 15.9167 2.25768 15.9167 2.21361V0.910808C15.9167 0.81876 15.8421 0.744141 15.75 0.744141C15.7057 0.744141 15.6632 0.7618 15.6319 0.793213L7.90908 8.54978L0.369491 0.801243C0.3053 0.735272 0.199782 0.73383 0.133811 0.798022C0.101565 0.829398 0.083374 0.87248 0.083374 0.917472V2.21512C0.083374 2.2583 0.100133 2.29979 0.130121 2.33086Z"/>
              </svg>
            </button>
          </div>
        </div>
        
        <!-- 活动规则内容容器 -->
        <div id="rulesContent" class="collapsible-content">

          <!-- 标题文案 -->
          <div class="form-group row-layout">
            <label class="non-interactive-label">标题文案</label>
            <input type="text" id="titleText" class="text-input" placeholder="请输入标题文案">
          </div>

          <!-- 标题背景 -->
          <div class="form-group row-layout">
            <label class="non-interactive-label">标题背景</label>
            <div class="file-upload-btn">
              <input type="file" id="footerImageUpload" accept="image/*" style="display:none">
              <button class="upload-btn" onclick="document.getElementById('footerImageUpload').click()">点击上传</button>
            </div>
          </div>
          
          <!-- 活动规则内容 -->
          <div class="form-group row-layout">
            <label class="non-interactive-label">活动规则</label>
            <textarea id="activityRules" class="text-area" placeholder="请输入活动规则内容"></textarea>
          </div>
          
        </div>
      </div>

      <!-- 尾版板块 -->
      <div class="form-section">
        <!-- 尾版标题 -->
        <div class="section-header">
          <span class="section-title">尾版</span>
          <div class="option-controls">
            <button class="control-btn collapse-btn" data-target="footerAreaContent">
              <svg width="12" height="7" viewBox="0 0 16 11" class="chevron-icon">
                <path d="M0.130121 2.33086L7.44223 9.90667C7.67195 10.1374 8.03601 10.151 8.28153 9.94739L8.32611 9.90667L15.8682 2.3312C15.8992 2.29996 15.9167 2.25768 15.9167 2.21361V0.910808C15.9167 0.81876 15.8421 0.744141 15.75 0.744141C15.7057 0.744141 15.6632 0.7618 15.6319 0.793213L7.90908 8.54978L0.369491 0.801243C0.3053 0.735272 0.199782 0.73383 0.133811 0.798022C0.101565 0.829398 0.083374 0.87248 0.083374 0.917472V2.21512C0.083374 2.2583 0.100133 2.29979 0.130121 2.33086Z"/>
              </svg>
            </button>
          </div>
        </div>
        
        <!-- 尾版内容容器 -->
        <div id="footerAreaContent" class="collapsible-content">
          <!-- LOGO -->
          <div class="form-group row-layout">
            <label class="non-interactive-label">LOGO</label>
            <div class="file-upload-btn">
              <input type="file" id="footerLogoUpload" accept="image/*" style="display:none" onchange="previewImage(this, this.nextElementSibling.querySelector('.img-preview-inline'))">
              <button class="upload-btn" onclick="document.getElementById('footerLogoUpload').click()">
                <div class="img-preview-inline">
                  <span class="upload-icon-inline">+</span>
                </div>
              </button>
            </div>
          </div>
          
          <!-- 尾版背景 -->
          <div class="form-group row-layout">
            <label class="non-interactive-label">尾版背景</label>
            <div class="file-upload-btn">
              <input type="file" id="footerBgUpload" accept="image/*" style="display:none">
              <button class="upload-btn" onclick="document.getElementById('footerBgUpload').click()">点击上传</button>
            </div>
          </div>
          
        </div>
      </div>

      <!-- 创建按钮容器 -->
      <div class="create-btn-container">
        <div class="button-group">
          <button class="create-btn" id="create">创建原型</button>
        </div>
      </div>
    </div>

    <!-- 延展渠道内容 -->
    <div class="tab-content" id="extension-content">
      <div class="empty-state">
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" class="empty-icon" viewBox="0 0 16 16">
          <path d="M8.186 1.113a.5.5 0 0 0-.372 0L1.846 3.5l2.404.961L10.404 2l-2.218-.887zm3.564 1.426L5.596 5 8 5.961 14.154 3.5l-2.404-.961zm3.25 1.7-6.5 2.6v7.922l6.5-2.6V4.24zM7.5 14.762V6.838L1 4.239v7.923l6.5 2.6zM7.443.184a1.5 1.5 0 0 1 1.114 0l7.129 2.852A.5.5 0 0 1 16 3.5v8.662a1 1 0 0 1-.629.928l-7.185 2.874a.5.5 0 0 1-.372 0L.63 13.09a1 1 0 0 1-.63-.928V3.5a.5.5 0 0 1 .314-.464L7.443.184z"/>
        </svg>
        <h3>暂无可用渠道</h3>
        <p>可通过创建原型进行渠道生成</p>
        <p class="gray-text">敬请期待</p>
      </div>
    </div>

    <!-- 工具集内容 -->
    <div class="tab-content" id="tools-content">
      <div class="empty-state">
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" class="empty-icon" viewBox="0 0 16 16">
          <path d="M1 0 0 1l2.2 3.081a1 1 0 0 0 .815.419h.07a1 1 0 0 1 .708.293l2.675 2.675-2.617 2.654A3.003 3.003 0 0 0 0 13a3 3 0 1 0 5.878-.851l2.654-2.617.968.968-.305.914a1 1 0 0 0 .242 1.023l3.27 3.27a.997.997 0 0 0 1.414 0l1.586-1.586a.997.997 0 0 0 0-1.414l-3.27-3.27a1 1 0 0 0-1.023-.242L10.5 9.5l-.96-.96 2.68-2.643A3.005 3.005 0 0 0 16 3c0-.269-.035-.53-.102-.777l-2.14 2.141L12 4l-.364-1.757L13.777.102a3 3 0 0 0-3.675 3.68L7.462 6.46 4.793 3.793a1 1 0 0 1-.293-.707v-.071a1 1 0 0 0-.419-.814L1 0Zm9.646 10.646a.5.5 0 0 1 .708 0l2.914 2.915a.5.5 0 0 1-.707.707l-2.915-2.914a.5.5 0 0 1 0-.708ZM3 11l.471.242.529.026.287.445.445.287.026.529L5 13l-.242.471-.026.529-.445.287-.287.445-.529.026L3 15l-.471-.242L2 14.732l-.287-.445L1.268 14l-.026-.529L1 13l.242-.471.026-.529.445-.287.287-.445.529-.026L3 11Z"/>
        </svg>
        <h3>工具库开发中</h3>
        <p>更多实用设计工具正在开发中</p>
        <p class="gray-text">敬请期待</p>
      </div>
    </div>

    <!-- 设置内容 -->
    <div class="tab-content" id="settings-content">
      <div class="form-section">
        <!-- 主题切换 -->
        <div class="form-group row-layout theme-switcher">
          <label>切换主题</label>
          <div class="theme-buttons">
            <button id="lightTheme" class="theme-btn active">
              <!-- <i class="bi bi-sun"></i> -->
              <span>浅色模式</span>
            </button>
            <button id="darkTheme" class="theme-btn">
              <!-- <i class="bi bi-moon"></i> -->
              <span>深色模式</span>
            </button>
          </div>
        </div>
      </div>

  </div>
  
  <!-- 页脚版本信息 -->
  <div class="page-footer">
    <div class="version-info">
      <span class="version-number">1.0.0</span>
      <span class="version-author">渠道美术制作</span>
    </div>
  </div>

  <!-- JavaScript 部分 -->
  <script>
    /**
     * 与Figma插件通信
     */
    // 全局变量存储图片数据
    const imageData = {
      pageBackground: null,
      headerImage: null,
      titleUpload: null,
      gameIcon: null,
      btnImage: null,
      footerLogo: null,
      footerBg: null,
      rulesBg: null
    };
    
    // 模块图片数据存储
    const moduleImageData = {};
    
    // 发送消息到Figma插件
    function postMessageToPlugin(type, data) {
      parent.postMessage({ pluginMessage: { type, ...data } }, '*');
    }
    
    // 初始化与插件通信
    window.onload = function() {
      // 监听来自插件的消息
      window.onmessage = function(event) {
        const message = event.data.pluginMessage;
        if (!message) return;
        
        console.log('收到插件消息:', message);
        
        switch (message.type) {
          case 'init':
            // 处理初始数据
            handleInitData(message.data);
            break;
          case 'creation-success':
            showNotification('原型创建成功！', 'success');
            break;
          case 'creation-error':
            showNotification('创建失败: ' + message.message, 'error');
            break;
          case 'save-success':
            showNotification('配置已保存', 'success');
            break;
          case 'save-error':
            showNotification('保存失败: ' + message.message, 'error');
            break;
          case 'load-config-success':
            if (message.config) {
              loadSavedConfig(message.config);
              showNotification('配置加载成功', 'success');
            }
            break;
          case 'load-config-error':
            showNotification('加载配置失败: ' + message.message, 'warning');
            break;
        }
      };
      
      // 告知插件UI已加载完成
      postMessageToPlugin('ui-loaded', {});
    };
    
    // 处理初始数据
    function handleInitData(data) {
      console.log('初始化数据:', data);
      // 这里可以根据数据设置一些UI元素的初始状态
    }
    
    // 显示通知
    function showNotification(message, type = 'info') {
      // 创建一个新的div元素作为通知
      const notification = document.createElement('div');
      // 设置通知元素的类名，包括通用的'notification'类和特定类型的类（如'success'、'error'等）
      notification.className = `notification ${type}`;
      // 设置通知元素的文本内容为传入的消息
      notification.textContent = message;
      
      // 添加到body
      document.body.appendChild(notification);
      
      // 淡入效果
      setTimeout(() => {
        // 设置通知元素的不透明度为1，使其完全可见
        notification.style.opacity = '1';
        // 重置通知元素的垂直位置，使其回到原始位置（无位移）
        notification.style.transform = 'translateY(0)';
      }, 10); // 延迟10毫秒执行，以确保DOM更新并应用初始样式
      
      // 几秒后自动淡出
      setTimeout(() => {
        // 设置通知元素的透明度为0，开始淡出效果
        notification.style.opacity = '0';
        // 向上移动通知元素，创造一个滑出效果
        notification.style.transform = 'translateY(-20px)';
        
        // 移除元素
        setTimeout(() => {
          // 从DOM中完全移除通知元素
          document.body.removeChild(notification);
        }, 300); // 300毫秒后执行，与CSS过渡效果的持续时间匹配
      }, 5000); // 5000毫秒（3秒）后开始淡出过程
    }
    
    // 收集表单数据
    function collectFormData() {
      const config = {
        // 基础设置
        pageTitle: document.title || "未命名H5活动页",
        pageBgColor: document.querySelector('#pageColor').value || "#D9D9D9",
        pageBgImage: imageData.pageBackground,
        
        // 头图设置
        headerImage: imageData.headerImage,
        
        // 游戏设置
        gameIcon: imageData.gameIcon,
        gameName: document.querySelector('#gameNameInput')?.value || "",
        gameDesc: document.querySelector('#gameCopyInput')?.value || "",
        buttonVersion: document.querySelector('#buttonVersionSelect')?.value || "imageButton",
        buttonText: document.querySelector('#buttonTextInput')?.value || "立即下载",
        buttonBgColor: document.querySelector('#btnTextColor')?.value || "#FFFFFF",
        buttonImage: imageData.btnImage,
        
        // 自定义模块
        modules: collectModulesData(),
        
        // 活动规则
        rulesTitle: document.querySelector('#titleText')?.value || "",
        rulesBgImage: imageData.rulesBg,
        rulesContent: document.querySelector('#activityRules')?.value || "",
        
        // 尾版
        footerLogo: imageData.footerLogo,
        footerBg: imageData.footerBg
      };
      
      return config;
    }
    
    // 收集模块数据
    function collectModulesData() {
      const modules = [];
      const moduleElements = document.querySelectorAll('#modulesContainer .module');
      
      moduleElements.forEach((moduleEl, index) => {
        const moduleType = moduleEl.className.includes('lottery') ? 'nineGrid' :
                          moduleEl.className.includes('signIn') ? 'signIn' :
                          moduleEl.className.includes('collect') ? 'collectCards' :
                          moduleEl.className.includes('activity') ? 'activityRules' : '';
        
        if (!moduleType) return;
        
        const moduleId = moduleEl.id || `module-${index}`;
        const moduleTitle = moduleEl.querySelector('.module-title')?.textContent || "模块" + (index + 1);
        
        // 根据模块类型收集不同的内容
        let moduleContent = {};
        
        switch(moduleType) {
          case 'nineGrid':
            moduleContent = collectNineGridData(moduleEl, moduleId);
            break;
          case 'signIn':
            moduleContent = collectSignInData(moduleEl, moduleId);
            break;
          case 'collectCards':
            moduleContent = collectCollectCardsData(moduleEl, moduleId);
            break;
          case 'activityRules':
            moduleContent = collectActivityRulesData(moduleEl, moduleId);
            break;
        }
        
        modules.push({
          id: moduleId,
          type: moduleType,
          title: moduleTitle,
          content: moduleContent
        });
      });
      
      return modules;
    }
    
    // 收集九宫格模块数据
    function collectNineGridData(moduleEl, moduleId) {
      return {
        mainTitle: moduleEl.querySelector('.big-title-input')?.value || "抽奖活动",
        titleBgImage: moduleImageData[`${moduleId}-titlebg`] || null,
        gridBgImage: moduleImageData[`${moduleId}-gridbg`] || null,
        drawButtonImage: moduleImageData[`${moduleId}-drawbtn`] || null,
        prizeBgImage: moduleImageData[`${moduleId}-prizebg`] || null,
        prizes: collectPrizes(moduleEl, moduleId)
      };
    }
    
    // 收集签到模块数据
    function collectSignInData(moduleEl, moduleId) {
      return {
        titleImage: moduleImageData[`${moduleId}-title`] || null,
        bgImage: moduleImageData[`${moduleId}-bg`] || null,
        daysCount: parseInt(moduleEl.querySelector('.days-count')?.value || "7"),
        dayIcon: moduleImageData[`${moduleId}-dayicon`] || null,
        signButton: moduleImageData[`${moduleId}-signbtn`] || null
      };
    }
    
    // 收集集卡模块数据
    function collectCollectCardsData(moduleEl, moduleId) {
      return {
        titleImage: moduleImageData[`${moduleId}-title`] || null,
        bgImage: moduleImageData[`${moduleId}-bg`] || null,
        cardsCount: parseInt(moduleEl.querySelector('.cards-count')?.value || "5"),
        cardStyle: moduleEl.querySelector('input[name="cardStyle"]:checked')?.value || "style1",
        cardBg: moduleImageData[`${moduleId}-cardbg`] || null,
        combineButton: moduleImageData[`${moduleId}-combinebtn`] || null
      };
    }
    
    // 收集活动内容模块数据
    function collectActivityRulesData(moduleEl, moduleId) {
      return {
        mainTitle: moduleEl.querySelector('.activity-rule-title-input')?.value || "",
        mainTitleBg: moduleImageData[`${moduleId}-titlebg`] || null,
        subTitle: moduleEl.querySelector('.small-title-input')?.value || "",
        subTitleBg: moduleImageData[`${moduleId}-subtitlebg`] || null,
        text: moduleEl.querySelector('.activity-rule-text-input')?.value || "",
        image: moduleImageData[`${moduleId}-image`] || null
      };
    }
    
    // 收集奖品数据
    function collectPrizes(moduleEl, moduleId) {
      const prizes = [];
      const prizeElements = moduleEl.querySelectorAll('.prize-grid .grid-item');
      
      prizeElements.forEach((prizeEl, index) => {
        prizes.push({
          image: moduleImageData[`${moduleId}-prize-${index}`] || null,
          name: prizeEl.querySelector('.prize-label')?.textContent || `奖品${index + 1}`
        });
      });
      
      return prizes;
    }
    
    // 处理图片文件上传
    function handleImageUpload(file, storageKey) {
      return new Promise((resolve, reject) => {
        if (!file || !file.type.startsWith('image/')) {
          return reject('请上传有效的图片文件');
        }
        
        const reader = new FileReader();
        reader.onload = function(e) {
          const arrayBuffer = e.target.result;
          const uint8Array = new Uint8Array(arrayBuffer);
          
          if (storageKey.startsWith('module-')) {
            moduleImageData[storageKey] = uint8Array;
          } else {
            imageData[storageKey] = uint8Array;
          }
          
          resolve(uint8Array);
        };
        
        reader.onerror = function() {
          reject('读取图片文件失败');
        };
        
        reader.readAsArrayBuffer(file);
      });
    }
    
    // 加载保存的配置
    function loadSavedConfig(config) {
      console.log('加载配置:', config);
      // 这里可以根据配置设置UI元素的状态
      // 实际实现需要根据完整的表单结构进行
    }
    
    /**
     * 工具函数
     */

    // 图片预览函数 - 接受输入元素和预览ID
    function previewImage(input, previewElement) {
      // 处理字符串类型的预览元素(ID)
      if (typeof previewElement === 'string') {
        const preview = document.getElementById(previewElement);
        if (preview) {
          handlePreview(input, preview);
        }
      } 
      // 处理DOM元素类型的预览元素
      else if (previewElement instanceof Element) {
        handlePreview(input, previewElement);
      }
      
      // 内部处理函数
      function handlePreview(input, preview) {
        // 重置预览区域
        preview.innerHTML = '<span class="upload-icon-inline">+</span>';
        
        if (input.files && input.files[0]) {
          const reader = new FileReader();
          
          reader.onload = function(e) {
            preview.innerHTML = '';
            const img = document.createElement('img');
            img.src = e.target.result;
            img.alt = "Preview";
            preview.appendChild(img);
          };
          
          reader.readAsDataURL(input.files[0]);
        }
      }
    }

    // 删除模块
    function removeModule(moduleId) {
      const module = document.getElementById(moduleId);
      if (module) {
        // 添加删除动画
        module.style.opacity = '0';
        module.style.transform = 'translateY(-10px)';
        module.style.transition = 'all 0.2s ease';
        
        // 动画完成后移除元素
        setTimeout(() => module.remove(), 200);
      }
    }

    /**
     * 模块管理
     */
    
    // 模块计数器
    let moduleCounter = 0;
    let fixedModuleCounter = 0;
    
    // 模块管理初始化
    function initModuleManagement() {
      const addModuleBtn = document.getElementById('addModuleBtn');
      const moduleTypeSelect = document.getElementById('moduleTypeSelect');
      const modulesContainer = document.getElementById('modulesContainer');
      const emptyMessage = document.getElementById('emptyModulesMessage');
      
      // 监听添加模块按钮点击
      if (addModuleBtn) {
        addModuleBtn.addEventListener('click', function() {
          const selectedModuleType = moduleTypeSelect.value;
          addModule(selectedModuleType);
        });
      }
      
      // 检查是否存在已添加的模块
      checkEmptyModules();
      
      // 添加模块的方法
      function addModule(moduleType) {
        // 获取对应模板
        const templateId = moduleType + 'Template';
        const template = document.getElementById(templateId);
        
        if (!template) {
          console.error('找不到模板:', templateId);
          return;
        }
        
        // 创建新模块
        const newModule = template.cloneNode(true);
        newModule.id = `module-${Date.now()}-${Math.floor(Math.random() * 1000)}`;
        newModule.classList.remove('module-template');
        newModule.classList.add('module');
        
        // 绑定控制按钮事件
        bindModuleControls(newModule);
        
        // 添加到容器
        modulesContainer.appendChild(newModule);
    
        // 隐藏空模块提示
        checkEmptyModules();
    
        // 滚动到新添加的模块
        setTimeout(() => {
          newModule.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }, 100);
    
        // 触发模块添加事件，用于初始化上传事件监听
        dispatchModuleAddedEvent(newModule.id);
      }
      
      // 绑定模块控制按钮事件
      function bindModuleControls(module) {
        // 删除按钮
        const deleteBtn = module.querySelector('.delete-btn');
        if (deleteBtn) {
          deleteBtn.addEventListener('click', function() {
            // 添加删除动画
            module.style.opacity = '0';
            module.style.transform = 'translateY(-10px)';
            module.style.transition = 'all 0.3s ease';
            
            // 删除后检查是否需要显示空模块提示
            setTimeout(() => {
              module.remove();
              checkEmptyModules();
            }, 300);
          });
        }
        
        // 折叠按钮
        const collapseBtn = module.querySelector('.collapse-btn');
        if (collapseBtn) {
          collapseBtn.addEventListener('click', function() {
            module.classList.toggle('module-collapsed');
          });
        }
        
        // 上移按钮
        const moveUpBtn = module.querySelector('.move-up-btn');
        if (moveUpBtn) {
          moveUpBtn.addEventListener('click', function() {
            const prevModule = module.previousElementSibling;
            if (prevModule && !prevModule.classList.contains('empty-modules-message')) {
              modulesContainer.insertBefore(module, prevModule);
            }
          });
        }
        
        // 下移按钮
        const moveDownBtn = module.querySelector('.move-down-btn');
        if (moveDownBtn) {
          moveDownBtn.addEventListener('click', function() {
            const nextModule = module.nextElementSibling;
            if (nextModule) {
              modulesContainer.insertBefore(nextModule, module);
            }
          });
        }
        
        // 文件上传预览
        const fileInputs = module.querySelectorAll('input[type="file"]');
        fileInputs.forEach(input => {
          input.addEventListener('change', function() {
            if (this.files && this.files[0]) {
              const reader = new FileReader();
              let previewContainer;
              
              // 查找预览容器
              if (this.classList.contains('prize-upload')) {
                // 奖品图特殊处理
                const gridBtn = this.nextElementSibling;
                previewContainer = gridBtn.querySelector('.preview-container');
                const uploadIcon = gridBtn.querySelector('.upload-icon');
                
                reader.onload = function(e) {
                  // 清除旧预览
                  while (previewContainer.firstChild) {
                    previewContainer.removeChild(previewContainer.firstChild);
                  }
                  
                  // 创建新图片预览
                  const img = document.createElement('img');
                  img.src = e.target.result;
                  img.alt = "Preview";
                  previewContainer.appendChild(img);
                  
                  // 隐藏上传图标
                  if (uploadIcon) {
                    uploadIcon.style.display = 'none';
                  }
                };
              } else {
                // 常规上传按钮
                const uploadBtn = this.nextElementSibling;
                
                // 检查是否有内联预览容器
                previewContainer = uploadBtn.querySelector('.img-preview-inline');
                
                if (previewContainer) {
                  reader.onload = function(e) {
                    // 清除旧预览内容
                    previewContainer.innerHTML = '';
                    
                    // 创建新图片预览
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.alt = "Preview";
                    previewContainer.appendChild(img);
                  };
                }
              }
              
              if (previewContainer) {
                reader.readAsDataURL(this.files[0]);
              }
            }
          });
        });
      }
    }
    
    // 检查是否有模块，显示或隐藏空模块提示，更新计数器
    function checkEmptyModules() {
      const modulesContainer = document.getElementById('modulesContainer');
      const emptyMessage = document.getElementById('emptyModulesMessage');
      
      if (modulesContainer && emptyMessage) {
        const modules = modulesContainer.querySelectorAll('.module');
        const moduleCount = modules.length;
        const hasModules = moduleCount > 0;
        
        // 显示或隐藏空模块提示
        emptyMessage.style.display = hasModules ? 'none' : 'flex';
        
        // 更新模块计数
        const counter = document.getElementById('moduleCounter');
        if (counter) {
          counter.textContent = moduleCount;
        }
      }
    }
    
    /**
     * 主题控制函数
     */
    
    // 应用浅色主题
    function applyLightTheme() {
      document.body.classList.remove('dark-theme');
      document.body.classList.add('light-theme');
    }
    
    // 应用深色主题
    function applyDarkTheme() {
      document.body.classList.remove('light-theme');
      document.body.classList.add('dark-theme');
    }
    
    // 检查系统主题
    function checkSystemTheme() {
      if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        applyDarkTheme();
        document.getElementById('darkTheme').classList.add('active');
        document.getElementById('lightTheme').classList.remove('active');
      } else {
        applyLightTheme();
        document.getElementById('lightTheme').classList.add('active');
        document.getElementById('darkTheme').classList.remove('active');
      }
    }
    
    /**
     * 页面初始化和事件绑定
     */
    document.addEventListener('DOMContentLoaded', function() {
      // 初始化模块管理
      initModuleManagement();
      
      // 初始化模块计数
      checkEmptyModules();
      
      // 初始化图片上传事件处理
      initImageUploaders();
      
      // 初始化创建按钮事件
      initCreateButtonHandler();
      
      // Tab切换功能
      const tabs = document.querySelectorAll('.tab');
      const tabContents = document.querySelectorAll('.tab-content');

      // 初始化标签状态 - 确保只有一个标签是活动的
      function initializeTabs() {
        // 获取当前活动标签
        const activeTab = document.querySelector('.tab.active');
        if (activeTab) {
          const activeTabId = activeTab.getAttribute('data-tab');
          
          // 隐藏所有内容区域
          tabContents.forEach(content => {
            content.classList.remove('active');
          });
          
          // 只显示当前活动标签对应的内容
          const activeContent = document.getElementById(`${activeTabId}-content`);
          if (activeContent) {
            activeContent.classList.add('active');
          } else {
            console.warn('未找到对应的内容区域:', activeTabId);
            tabs[0]?.classList.add('active');
            document.getElementById(`${tabs[0]?.dataset.tab}-content`)?.classList.add('active');
          }
        }
      }
      
      // 页面加载时初始化标签状态
      initializeTabs();
      
      // 默认激活第一个标签（如果当前没有激活项）
      if (!document.querySelector('.tab.active')) {
        tabs[0]?.classList.add('active');
        const firstContent = document.getElementById(`${tabs[0]?.dataset.tab}-content`);
        firstContent?.classList.add('active');
      }
      
      // 为所有标签添加点击事件
      tabs.forEach(tab => {
        tab.addEventListener('click', function() {
          // 移除所有选项卡的活动状态
          tabs.forEach(t => t.classList.remove('active'));
          
          // 添加当前选项卡的活动状态
          this.classList.add('active');
          
          // 隐藏所有内容区域
          document.querySelectorAll('.tab-content').forEach(content => {
            content.classList.remove('active');
          });
          
          // 显示当前选项卡对应的内容区域
          const tabId = this.getAttribute('data-tab');
          if (!tabId) {
            console.error('无效的标签ID');
            return;
          }
          const targetContent = document.getElementById(`${tabId}-content`);
          if (!targetContent) {
            console.error('找不到内容区域:', tabId);
            this.classList.remove('active');
            tabs[0]?.classList.add('active');
            document.getElementById(`${tabs[0]?.dataset.tab}-content`)?.classList.add('active');
            return;
          }
          targetContent.classList.add('active');
        });
      });
      
      // 按钮版本选择功能
      const buttonVersionSelect = document.getElementById('buttonVersionSelect');
      const buttonVersionContents = document.querySelectorAll('#buttonVersionContent .version-content');
      
      if (buttonVersionSelect) {
        buttonVersionSelect.addEventListener('change', function() {
          // 隐藏所有按钮版本内容
          buttonVersionContents.forEach(content => content.classList.remove('active'));
          
          // 显示选中的按钮版本内容
          document.getElementById(`${this.value}Content`).classList.add('active');
        });
      }
      
      // 折叠面板功能
      const collapseButtons = document.querySelectorAll('.collapse-btn');
      
      collapseButtons.forEach(button => {
        button.addEventListener('click', function() {
          const targetId = this.getAttribute('data-target');
          const contentElement = document.getElementById(targetId);
          
          if (contentElement) {
            // 切换按钮样式
            this.classList.toggle('collapsed');
            
            // 切换内容区域的折叠状态
            contentElement.classList.toggle('collapsed');
          }
        });
      });
      
      // 颜色选择器同步功能
      const colorInputs = document.querySelectorAll('input[type="color"]');
      
      colorInputs.forEach(colorInput => {
        const colorValueInput = colorInput.nextElementSibling;
        
        if (colorValueInput) {
          colorInput.addEventListener('input', function() {
            colorValueInput.value = this.value.toUpperCase();
          });
          
          colorValueInput.addEventListener('input', function() {
            if (/^#[0-9A-F]{6}$/i.test(this.value)) {
              colorInput.value = this.value;
            }
          });
        }
      });

      // 主题切换功能
      const lightThemeBtn = document.getElementById('lightTheme');
      const darkThemeBtn = document.getElementById('darkTheme');
      
      // 初始检查系统主题
      checkSystemTheme();
      
      // 监听系统主题变化
      if (window.matchMedia) {
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', checkSystemTheme);
      }
      
      // 点击浅色主题按钮
      if (lightThemeBtn) {
        lightThemeBtn.addEventListener('click', function() {
          applyLightTheme();
          lightThemeBtn.classList.add('active');
          darkThemeBtn.classList.remove('active');
        });
      }
      
      // 点击深色主题按钮
      if (darkThemeBtn) {
        darkThemeBtn.addEventListener('click', function() {
          applyDarkTheme();
          darkThemeBtn.classList.add('active');
          lightThemeBtn.classList.remove('active');
        });
      }

      // 奖品图片上传和预览功能
      const prizeUploads = document.querySelectorAll('.prize-upload');
      
      prizeUploads.forEach(upload => {
        upload.addEventListener('change', function(event) {
          if (this.files && this.files[0]) {
            const reader = new FileReader();
            const btn = document.querySelector(`button[onclick="document.getElementById('${this.id}').click()"]`);
            
            if (btn) {
              const previewContainer = btn.querySelector('.preview-container');
              const uploadIcon = btn.querySelector('.upload-icon');
              
              reader.onload = function(e) {
                // 清除旧预览
                if (previewContainer) {
                  while (previewContainer.firstChild) {
                    previewContainer.removeChild(previewContainer.firstChild);
                  }
                  
                  // 创建新图片预览
                  const img = document.createElement('img');
                  img.src = e.target.result;
                  img.alt = "Prize preview";
                  previewContainer.appendChild(img);
                }
                
                // 隐藏上传图标
                if (uploadIcon) {
                  uploadIcon.style.display = 'none';
                }
                
                // 更改按钮样式
                btn.style.border = '1px solid rgba(0, 113, 227, 0.5)';
              };
              
              reader.readAsDataURL(this.files[0]);
            }
          }
        });
      });

      // 游戏图标上传和预览功能
      const gameIconUpload = document.getElementById('gameIconUpload');
      if (gameIconUpload) {
        gameIconUpload.addEventListener('change', function(event) {
          if (this.files && this.files[0]) {
            const reader = new FileReader();
            const previewContainer = document.getElementById('gameIconPreview');
            
            reader.onload = function(e) {
              if (previewContainer) {
                // 清除旧预览内容
                previewContainer.innerHTML = '';
                
                // 创建新图片预览
                const img = document.createElement('img');
                img.src = e.target.result;
                img.alt = "Game Icon Preview";
                previewContainer.appendChild(img);
                
                // 更改容器样式
                previewContainer.style.border = '1px solid rgba(0, 113, 227, 0.5)';
              }
            };
            
            reader.readAsDataURL(this.files[0]);
          }
        });
      }
    });
    
    /**
     * 初始化图片上传处理
     */
    function initImageUploaders() {
      // 通用上传事件监听处理
      function addUploadListener(inputId, storageKey) {
        const input = document.getElementById(inputId);
        if (input) {
          input.addEventListener('change', async function() {
            if (this.files && this.files[0]) {
              try {
                await handleImageUpload(this.files[0], storageKey);
                showNotification(`${inputId}上传成功`, 'success');
              } catch (error) {
                showNotification(`上传失败: ${error}`, 'error');
              }
            }
          });
        }
      }
      
      // 添加主要图片上传监听
      addUploadListener('pageBackground', 'pageBackground');
      addUploadListener('headerImage', 'headerImage');
      addUploadListener('titleUpload', 'titleUpload');
      addUploadListener('gameIconUpload', 'gameIcon');
      addUploadListener('btnImageUpload', 'btnImage');
      addUploadListener('footerImageUpload', 'footerLogo');
      addUploadListener('footerBgUpload', 'footerBg');
      
      // 监听动态添加的模块图片上传
      document.addEventListener('moduleAdded', function(e) {
        const moduleId = e.detail.moduleId;
        const moduleEl = document.getElementById(moduleId);
        
        if (!moduleEl) return;
        
        // 为模块内的所有图片上传添加事件监听
        moduleEl.querySelectorAll('input[type="file"]').forEach((input, index) => {
          const inputType = input.className;
          let storageKey = '';
          
          if (inputType.includes('prize-upload')) {
            storageKey = `${moduleId}-prize-${index}`;
          } else if (inputType.includes('derived-item-upload') || inputType.includes('nine-grid-bg')) {
            storageKey = `${moduleId}-titlebg`;
          } else if (inputType.includes('draw-btn')) {
            storageKey = `${moduleId}-drawbtn`;
          } else if (inputType.includes('prize-bg')) {
            storageKey = `${moduleId}-prizebg`;
          } else if (inputType.includes('sign-in-title-upload')) {
            storageKey = `${moduleId}-title`;
          } else if (inputType.includes('sign-in-bg-upload')) {
            storageKey = `${moduleId}-bg`;
          } else if (inputType.includes('day-icon-upload')) {
            storageKey = `${moduleId}-dayicon`;
          } else if (inputType.includes('sign-in-btn-upload')) {
            storageKey = `${moduleId}-signbtn`;
          } else if (inputType.includes('collect-title-upload')) {
            storageKey = `${moduleId}-title`;
          } else if (inputType.includes('collect-bg-upload')) {
            storageKey = `${moduleId}-bg`;
          } else if (inputType.includes('card-bg-upload')) {
            storageKey = `${moduleId}-cardbg`;
          } else if (inputType.includes('combine-button-upload')) {
            storageKey = `${moduleId}-combinebtn`;
          } else if (inputType.includes('activity-rule-item-upload')) {
            storageKey = `${moduleId}-titlebg`;
          } else if (inputType.includes('small-title-upload')) {
            storageKey = `${moduleId}-subtitlebg`;
          } else if (inputType.includes('activity-rule-text-upload')) {
            storageKey = `${moduleId}-image`;
          }
          
          if (storageKey) {
            input.addEventListener('change', async function() {
              if (this.files && this.files[0]) {
                try {
                  await handleImageUpload(this.files[0], storageKey);
                  showNotification('图片上传成功', 'success');
                } catch (error) {
                  showNotification(`上传失败: ${error}`, 'error');
                }
              }
            });
          }
        });
      });
    }
    
    /**
     * 初始化创建按钮事件处理
     */
    function initCreateButtonHandler() {
      const createButton = document.getElementById('create');
      if (createButton) {
        createButton.addEventListener('click', function() {
          // 显示加载状态
          this.disabled = true;
          this.textContent = '处理中...';
          
          try {
            // 收集表单数据
            const config = collectFormData();
            console.log('收集的表单数据:', config);
            
            // 发送数据到插件
            postMessageToPlugin('create-prototype', { config });
            
            // 创建过程可能需要一点时间，显示提示
            showNotification('正在创建H5原型...', 'info');
          } catch (error) {
            console.error('创建失败:', error);
            showNotification(`创建失败: ${error.message || '未知错误'}`, 'error');
            this.disabled = false;
            this.textContent = '创建原型';
          }
        });
      }
    }
    
    // 添加模块事件分发
    function dispatchModuleAddedEvent(moduleId) {
      document.dispatchEvent(new CustomEvent('moduleAdded', { 
        detail: { moduleId } 
      }));
    }
  </script>
</body>
</html>


